import{d as P,a as C,u as $,r,e as D,v as S,f as Q,m as U,j as a}from"./index-xX-JJYLz.js";function L(){var j,h,N;const{id:n}=P(),l=C(),{t:e}=$("pages"),i=r.useMemo(()=>D.find(s=>s.id===parseInt(n)),[n]),v=localStorage.getItem("avatar"),m=localStorage.getItem("nombre"),x=localStorage.getItem("accesoQR"),t=r.useRef(null),[u,p]=r.useState(!1),f=r.useCallback(s=>{s===t.current&&o.current&&!o.current.paused?(o.current.pause(),b(!1)):s===o.current&&t.current&&!t.current.paused&&(t.current.pause(),p(!1))},[]),A=r.useCallback(()=>{t.current&&(f(t.current),u?t.current.pause():t.current.play().catch(s=>{console.warn("Autoplay bloqueado por el navegador (audio principal):",s)}),p(s=>!s))},[u,f]),o=r.useRef(null),[g,b]=r.useState(!1),k=r.useCallback(()=>{o.current&&(f(o.current),g?o.current.pause():o.current.play().catch(s=>{console.warn("Autoplay bloqueado por el navegador (audio alternativo):",s)}),b(s=>!s))},[g,f]);r.useEffect(()=>{if(x!=="true"||!S(m)||!Q(v)){alert(e("actividad.accesoDenegado")),l("/EscanerQR");return}i&&U(Number(n))},[n,l,v,m,x,i,e]),r.useEffect(()=>()=>{t.current&&(t.current.pause(),p(!1)),o.current&&(o.current.pause(),b(!1))},[n]);const d=r.useCallback(s=>{if(!s)return"";const y=`/04-WebApp-Prehistoria/${s.startsWith("/")?s.substring(1):s}`;return console.log(`[DEBUG] URL de asset: ${y}`),y},[]);if(!i)return a.jsxs("div",{className:"actividad-container",style:{backgroundImage:`url("${d("assets/images/nogenially/error-default.jpeg")}")`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed"},children:[a.jsx("p",{className:"error-msg",children:e("actividad.errorActividadNoEncontrada")}),a.jsxs("button",{className:"btn-volver-mapa",onClick:()=>l("/"),children:[" ",e("actividad.volverInicio")]})]});if(!v||!m)return a.jsxs("div",{className:"actividad-container",style:{backgroundImage:`url("${d("assets/images/nogenially/acceso-denegado.jpeg")}")`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed"},children:[a.jsx("p",{className:"error-msg",children:e("actividad.accesoDenegado")}),a.jsx("button",{className:"btn-volver-mapa",onClick:()=>l("/"),children:e("actividad.volverInicio")})]});const R=d(i.imagenFondo||i.imagenAlternativa),E=d(`assets/avatars/${v}.png`),I=i.geniallyURL&&i.geniallyURL.trim()!==""&&i.geniallyURL!=="#",c=r.useMemo(()=>e(`${n}`,{returnObjects:!0}),[n,e]);return a.jsxs("div",{className:"actividad-container",style:{backgroundImage:`url("${R}")`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed"},children:[a.jsxs("div",{className:"saludo-titulo",children:[a.jsxs("div",{className:"titulo-mensaje",children:[a.jsx("h3",{children:c.titulo}),((j=c.avatarDialogo)==null?void 0:j.mensaje)&&c.avatarDialogo.mensaje!=="#"&&a.jsx("p",{children:c.avatarDialogo.mensaje})]}),a.jsxs("div",{className:"actividad-header",children:[a.jsx("img",{src:E,alt:e("altText.avatar"),className:"avatar-actividad"}),a.jsxs("div",{children:[a.jsx("h2",{className:"saludo1",children:e("actividad.saludo",{nombre:m})}),((h=c.avatarDialogo)==null?void 0:h.dialogo)&&a.jsx("p",{className:"dialogo",children:c.avatarDialogo.dialogo})]})]})]}),i.audio&&a.jsxs("div",{className:"audio-button-container",children:[a.jsxs("button",{onClick:A,className:`audio-button ${u?"playing":""}`,"aria-label":e(u?"actividad.pausarAudio":"actividad.reproducirAudio"),children:[a.jsx("i",{className:`fa-solid ${u?"fa-pause":"fa-play"}`})," ",e("Reproducir audio")]}),a.jsx("audio",{ref:t,src:d(i.audio),preload:"auto",onEnded:()=>p(!1)}),i.audioENG&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:k,className:`audio-button-alt ${g?"playing":""}`,"aria-label":e(g?"actividad.pausarAudioENG":"Play audio"),children:[a.jsx("i",{className:`fa-solid ${g?"fa-pause":"fa-play"}`})," ",e("Play audio")]}),a.jsx("audio",{ref:o,src:d(i.audioENG),preload:"auto",onEnded:()=>b(!1)})]})]}),((N=c.avatarDialogo)==null?void 0:N.sabiasQue)&&c.avatarDialogo.sabiasQue!=="#"&&a.jsxs("p",{className:"sabiasque",children:[a.jsx("strong",{children:e("actividad.sabiasQue")})," ",c.avatarDialogo.sabiasQue]}),I?a.jsx("div",{className:"actividad-genially",children:a.jsx("iframe",{src:i.geniallyURL,width:"100%",height:"clamp(300px, 70vh, 700px)",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})}):a.jsx("div",{className:"actividad-siguiente",children:a.jsxs("button",{className:"btn-siguiente",onClick:()=>l("/EscanerQR"),children:[a.jsx("span",{className:"icon",children:"ðŸ“²"})," ",e("Escanear codigo QR")]})}),a.jsxs("div",{className:"navigation-footer",children:[" ",a.jsxs("button",{className:"btn-volver",onClick:()=>l("/entre-actividad"),children:[a.jsx("i",{className:"fa-solid fa-arrow-left"})," ",e("Mapa")]})]})]})}export{L as default};
